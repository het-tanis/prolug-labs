### Lab Activities

One of your support teams has limited capabilites to deploy into your environments. They have been complaining of problems with deployments every few weeks. You set out to create an automation that tests that you can:

1. Create a namespace

2. Deploy a resource

3. Delete that resource

4. Delete the namespace

You intend to run this automation daily as their service account so that you can verify their capabilities daily and try to catch any issues before their team does.


<br>
<details>
<summary>Solution</summary>

Start by creating your automation file.

vi unit7_kubernetes_test_creation.yaml

```plain
- hosts: localhost
  gather_facts: true
  vars:
  tasks:
   
  - name: Create a k8s namespace
    kubernetes.core.k8s:
      name: daily-test
      api_version: v1
      kind: Namespace
      state: present
```

Verify you can create the namespace.



```plain
ansible-playbook unit7_kubernetes_test_creation.yaml
```{{exec}}

Check the namespaces and then delete the daily-test

```plain
kubectl get ns
kubectl delete ns daily-test
```{{exec}}

Add in the creation of a pod.

```plain
  - name: create resource using name generated by the server
    kubernetes.core.k8s:
      state: present
      generate_name: nginx-
      definition:
        apiVersion: v1
        metadata:
          namespace: daily-test
        kind: Pod
         spec:
          containers:
          - name: nginx
            image: nginx
            imagePullPolicy: IfNotPresent
```

Execute the deployment

```plain
ansible-playbook unit7_kubernetes_test_creation.yaml
```{{exec}}

Verify that the namespace and the pod have been created

```plain
kubectl get all -n daily-test
```{{exec}}

Think about how you can add variables to both the name and the types of items being deployed for how the team may give you variables.

</details>